<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>User Deprovisioning Tool</title>
	<link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
	<div class="container">
    	<div class="header">
        	<h1>üîí User Deprovisioning Tool</h1>
        	<p>Simple credential-based account restriction tool</p>
    	</div>


    	<div class="form-section">
        	<!-- Compact Top Section -->
        	<div class="top-section">
            	<!-- Status Bar -->
            	<div class="status-bar">
                	<span class="status-item">‚òÅÔ∏è M365: <span id="graphStatus">‚úÖ {{ config_status.user_name }}</span></span>
                	<span class="status-item">üè¢ AD: <span id="adStatus">Ready</span></span>
                	<span class="status-item">üîß Service: <span id="serviceStatus">Ready</span></span>
                	<span class="status-item">üìÅ OU: <span id="ouStatus">Ready</span></span>
                	<a href="{{ url_for('logout') }}" class="logout-link">üö™ Logout</a>
            	</div>
           	 
            	<!-- Input Row -->
            	<div class="input-row">
                	<div class="input-group">
                    	<label for="userEmail">üéØ Target User</label>
                    	<input type="email" id="userEmail" placeholder="user@domain.com" required>
                	</div>
                	<div class="input-group">
                    	<label for="adUsername">üë§ AD Username</label>
                    	<input type="text" id="adUsername" placeholder="username or user@domain.com" required>
                	</div>
                	<div class="input-group">
                    	<label for="adPassword">üîë AD Password</label>
                    	<input type="password" id="adPassword" placeholder="Your AD password" required>
                	</div>
            	</div>
        	</div>


        	<!-- Action Categories -->
        	<div class="actions-grid">
            	<div class="action-category">
                	<div class="category-header" onclick="toggleCategory('ad')">
                    	<span class="category-icon">üè¢</span>
                    	<span class="category-title">Active Directory</span>
                    	<div class="toggle-switch active" id="adToggle">
                        	<div class="toggle-slider"></div>
                    	</div>
                	</div>
                	<div class="checkbox-list" id="adActions">
                    	<label class="checkbox-item critical">
                        	<input type="checkbox" id="disableAD" checked>
                        	<span class="action-name">Disable Account</span>
                    	</label>
                    	<label class="checkbox-item critical">
                        	<input type="checkbox" id="expireAD" checked>
                        	<span class="action-name">Set Expiration</span>
                    	</label>
                    	<label class="checkbox-item high">
                        	<input type="checkbox" id="resetADPassword" checked>
                        	<span class="action-name">Reset Password</span>
                    	</label>
                	</div>
            	</div>


            	<div class="action-category">
                	<div class="category-header" onclick="toggleCategory('m365')">
                    	<span class="category-icon">‚òÅÔ∏è</span>
                    	<span class="category-title">Microsoft 365</span>
                    	<div class="toggle-switch active" id="m365Toggle">
                        	<div class="toggle-slider"></div>
                    	</div>
                	</div>
                	<div class="checkbox-list" id="m365Actions">
                    	<label class="checkbox-item critical">
                        	<input type="checkbox" id="disableM365" checked>
                        	<span class="action-name">Disable Account</span>
                    	</label>
                    	<label class="checkbox-item high">
                        	<input type="checkbox" id="revokeSessions" checked>
                        	<span class="action-name">Revoke Sessions</span>
                    	</label>
                	</div>
            	</div>


            	<div class="action-category">
                	<div class="category-header" onclick="toggleCategory('mfa')">
                    	<span class="category-icon">üõ°Ô∏è</span>
                    	<span class="category-title">MFA & Security</span>
                    	<div class="toggle-switch active" id="mfaToggle">
                        	<div class="toggle-slider"></div>
                    	</div>
                	</div>
                	<div class="checkbox-list" id="mfaActions">
                    	<label class="checkbox-item high">
                        	<input type="checkbox" id="removeMFA" checked>
                        	<span class="action-name">Remove MFA Methods</span>
                    	</label>
                	</div>
            	</div>


            	<div class="action-category">
                	<div class="category-header" onclick="toggleCategory('org')">
                    	<span class="category-icon">üìÅ</span>
                    	<span class="category-title">Organizational</span>
                    	<div class="toggle-switch active" id="orgToggle">
                        	<div class="toggle-slider"></div>
                    	</div>
                	</div>
                	<div class="checkbox-list" id="orgActions">
                    	<label class="checkbox-item medium">
                        	<input type="checkbox" id="moveToTerminated" checked>
                        	<span class="action-name">Move to Terminated OU</span>
                    	</label>
                	</div>
            	</div>
        	</div>


        	<!-- Action Buttons -->
        	<div class="action-buttons">
            	<button class="btn btn-test" onclick="testConnections()" id="testBtn">üîç Test</button>
            	<button class="btn btn-primary" onclick="startDeprovisioning()" id="deprovisionBtn">üö® Deprovision</button>
            	<button class="btn btn-secondary" onclick="clearLog()">üóëÔ∏è Clear</button>
        	</div>


        	<!-- Progress -->
        	<div class="progress-container">
            	<div class="progress-bar">
                	<div class="progress-fill" id="progressFill"></div>
            	</div>
            	<div class="progress-text" id="progressText">Ready</div>
        	</div>
    	</div>


    	<!-- Log Section -->
    	<div class="log-section">
        	<div class="log-header">üìã Execution Log</div>
        	<div id="logContainer" class="log-container"></div>
    	</div>
	</div>


	<!-- Confirmation Modal -->
	<div id="confirmationModal" class="modal" style="display:none;">
    	<div class="modal-content">
        	<div class="modal-header">
            	<h2>üö® CRITICAL WARNING</h2>
        	</div>
        	<div class="modal-body">
            	<p>You are about to PERMANENTLY modify:</p>
            	<div class="user-email" id="confirmUserEmail"></div>
            	<div class="auth-details">
                	<p>M365: OAuth ({{ config_status.user_email }})</p>
                	<p>AD: <span id="confirmAdUser"></span></p>
            	</div>
            	<div class="warning-box">
                	‚ö†Ô∏è These actions CANNOT be easily undone!
            	</div>
            	<p>Type "CONFIRM" to proceed:</p>
            	<input type="text" id="confirmationInput" placeholder="Type CONFIRM here">
        	</div>
        	<div class="modal-footer">
            	<button class="btn btn-secondary" onclick="closeConfirmation()">Cancel</button>
            	<button class="btn btn-primary" onclick="proceedWithDeprovisioning()" id="proceedBtn" disabled>
                	Proceed
            	</button>
        	</div>
    	</div>
	</div>


	<script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>


